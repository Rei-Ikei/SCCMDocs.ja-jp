---
title: 探索の構成
titleSuffix: Configuration Manager
description: 探索方法を構成して、ネットワーク、Active Directory、および Azure Active Directory から管理するリソースを検索します。
ms.date: 08/30/2018
ms.prod: configuration-manager
ms.technology: configmgr-other
ms.topic: conceptual
ms.assetid: 49505eb1-d44d-4121-8712-e0f3d8b15bf5
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: e232875aab086dea04261abc4d83df8d5d03e6c8
ms.sourcegitcommit: aca62bd3d267b1dbea46d4db6f32d797c5f6263c
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/31/2018
ms.locfileid: "43347972"
---
# <a name="configure-discovery-methods-for-configuration-manager"></a>Configuration Manager の探索方法を構成する

*適用対象: System Center Configuration Manager (Current Branch)*


探索方法を構成して、ネットワーク、Active Directory、および Azure Active Directory (Azure AD) から管理するリソースを検索します。 最初に環境の検索に使用する各方法を有効にしてから構成します。 探索方法は、有効にするのと同じ手順で無効にすることもできます。 このプロセスの唯一の例外は、定期探索とサーバー検出です。  

-   既定では、**定期探索**は、Configuration Manager プライマリ サイトをインストールするときに既に有効になっています。 これは基本スケジュールで実行するために構成されています。 定期探索は有効にしたままにしてください。 定期探索によってデバイスの探索データ レコード (DDR) が確実に最新の状態になります。 定期探索の詳細については、「[定期探索について](/sccm/core/servers/deploy/configure/about-discovery-methods#bkmk_aboutHeartbeat)」を参照してください。  

-   **サーバー検出**は自動検出方法です。 サイト システムとして使用しているコンピューターを検索します。 構成も無効化も実行できません。  

### <a name="enable-a-configurable-discovery-method"></a>構成可能な探索方法を有効にする  
 > [!NOTE]  
 > 次の情報は、Azure AD ユーザー探索には適用されません。 代わりに、この記事で後述する「[Azure AD ユーザー探索を構成する](#azureaadisc)」を参照してください。

1.  Configuration Manager コンソールで **[管理]** ワークスペースに移動し、**[階層の構成]** を展開してから、**[探索方法]** を選択します。  

2.  探索を有効にするサイトの探索方法を選択します。  

3.  リボンの **[ホーム]** タブの **[プロパティ]** グループで、**[プロパティ]** を選択します。 次に、**[全般]** タブで、**[&lt;探索方法\> を有効にする]** オプションを選択します。  

     このオプションが既に有効になっている場合、チェック ボックスをオフにすることで、探索方法を無効にできます。  

4.  **[OK]** を選択して構成を保存します。  



##  <a name="BKMK_ConfigADForestDisc"></a> Active Directory フォレストの探索の構成  

Active Directory フォレストの探索の構成を完了するには、Configuration Manager コンソール次の 2 つの場所で設定を構成します。  

- **[探索方法]** ノードで、次の操作を行います。

    - 探索方法を有効にします。  

    - ポーリングのスケジュールを設定します。  

    - 探索対象の Active Directory サイトとサブネットの境界を自動的に作成するかどうかを選択します。  

- **[Active Directory フォレスト]** ノードで、次の操作を行います。

    - 探索するフォレストを追加します。  

    - そのフォレストでの Active Directory サイトとサブネットの探索を有効にします。  

    - Configuration Manager サイトがサイト情報をフォレストに発行できるようにする設定を構成します。  

    - 各フォレストで Active Directory フォレスト アカウントとして使用するアカウントを割り当てます。  

Active Directory フォレストの探索を有効にし、Active Directory フォレストの探索で使用する個々のフォレストを構成するには、次の手順に従います。  


### <a name="enable-active-directory-forest-discovery"></a>Active Directory フォレストの探索を有効にする  

1.  Configuration Manager コンソールで **[管理]** ワークスペースに移動し、**[階層の構成]** を展開して、**[探索方法]** ノードを選択します。  

2.  探索を構成するサイトの Active Directory フォレストの探索方法を選択します。  

3.  リボンの **[ホーム]** タブの **[プロパティ]** グループで、**[プロパティ]** を選択します。  

4.  **[全般]** タブで、探索を有効にするチェック ボックスをオンにします。 先に探索を構成し、後で探索を有効にすることもできます。  

5.  探索する場所に対してサイト境界を作成するオプションを指定します。  

6.  探索を実行するスケジュールを指定します。  

7.  **[OK]** を選択して構成を保存します。  


### <a name="configure-a-forest-for-active-directory-forest-discovery"></a>Active Directory フォレストの探索のフォレストを構成する  

1.  **[管理]** ワークスペースで、**[階層の構成]** を展開し、**[Active Directory フォレスト]** ノードを選択します。 Active Directory フォレストの検索を前に実行している場合は、検出されたフォレストが結果ウィンドウに表示されます。 Active Directory フォレストの探索を実行すると、ローカル フォレストと信頼済みフォレストがすべて探索されます。 信頼済みではないフォレストを手動で追加するだけでかまいません。  

    -   既に検出済みのフォレストを構成するには、結果ウィンドウでそのフォレストを選択します。 次に、リボンの **[ホーム]** タブの **[プロパティ]** グループで、**[プロパティ]** を選択してフォレストのプロパティを開きます。 手順 3 に進みます。  

    -   一覧に示されていない新しいフォレストを構成するには、リボンの **[ホーム]** タブの **[作成]** グループで、**[フォレストの追加]** を選択します。 この操作で、**[フォレストの追加]** ダイアログ ボックスが開かれます。 手順 3 に進みます。  

2.  **[全般]** タブで、探索するフォレストの構成を完了し、**[Active Directory フォレスト アカウント]** を指定します。 このアカウントの詳細については、[アカウント](/sccm/core/plan-design/hierarchy/accounts#active-directory-forest-account)に関するページを参照してください。  

    > [!NOTE]  
    >  Active Directory フォレストの探索で、信頼されていないフォレストを検出して、そのフォレストに発行するにはグローバル アカウントが必要です。 サイト サーバーのコンピューター アカウントを使用しない場合は、グローバル アカウントのみ選択できます。  

3.  サイト データをこのフォレストに発行できるようにする場合は、**[発行]** タブで、必要な構成を行います。  

    > [!NOTE]  
    >  サイトをフォレストに発行できるようにする場合は、Configuration Manager 用にそのフォレストの Active Directory スキーマを拡張します。 Active Directory フォレスト アカウントには、そのフォレストの System コンテナーに対するフル コントロールのアクセス許可が必要です。  

4.  **[OK]** を選択して構成を保存します。  



##  <a name="BKMK_ConfigADDiscGeneral"></a> Active Directory のコンピューター、ユーザー、またはグループの探索の構成  

コンピューター、ユーザー、またはグループの探索を構成するには、次に示す一般的な手順から開始します。

1.  Configuration Manager コンソールで **[管理]** ワークスペースに移動し、**[階層の構成]** を展開して、**[探索方法]** ノードを選択します。  

2.  探索を構成するサイトの探索方法を選択します。  

3.  リボンの **[ホーム]** タブの **[プロパティ]** グループで、**[プロパティ]** を選択します。  

4.  **[全般]** タブで、探索を有効にするチェック ボックスをオンにします。 先に探索を構成し、後で探索を有効にすることもできます。  

特定の探索方法を構成するには、以下のセクションの情報を参照してください。  

- [Active Directory グループの探索](#bkmk_config-adgd)  

- [Active Directory システムの探索](#bkmk_config-adgd)  

- [Active Directory ユーザー検出](#bkmk_config-adud)  

> [!NOTE]  
>  このセクションの情報は、Active Directory フォレストの探索には当てはまりません。  

 これらの各探索方法は相互に独立していますが、同様のオプションを使用します。 これらの構成オプションに関する詳細については、「[Shared options for Group, System, and User discovery](/sccm/core/servers/deploy/configure/about-discovery-methods#bkmk_shared)」(グループ、システム、ユーザー探索の共有オプション) を参照してください。  

> [!WARNING]  
>  これらの各探索方法での Active Directory ポーリングで、大量のネットワーク トラフィックが発生する可能性があります。 このネットワーク トラフィックが業務上のネットワークの使用に悪影響を及ぼさない時間帯に各探索が実行されるように、探索のスケジュールを設定する必要があります。  


### <a name="bkmk_config-adgd"></a> Active Directory グループの探索の構成  

1. Active Directory グループ探索の [プロパティ] ウィンドウの **[全般]** タブで、**[追加]** を選択して探索のスコープを構成します。 **[グループ]** または **[場所]** のいずれかを選択します。 次に、**[グループの追加]** または **[Active Directory の場所の追加]** ダイアログ ボックスで次の構成を完了します。  

    1.  この探索スコープの **[名前]** を指定します。  

    2.  **[Active Directory ドメイン]** または **[場所]** を指定して検索します。  

        -   **[グループ]** を選択した場合、探索する 1 つまたは複数の Active Directory グループを指定します。  

        -   **[場所]** を選択した場合、探索する場所として Active Directory コンテナーを指定します。 この場所に対して Active Directory の子コンテナーの再帰検索を有効にすることもできます。  

    3.  この探索スコープを検索するためにサイトで使用する **[Active Directory グループ探索アカウント]** を指定します。 詳細については、[アカウント](/sccm/core/plan-design/hierarchy/accounts#active-directory-group-discovery-account)に関するページを参照してください。  

    4.  **[OK]** を選択して探索スコープの構成を保存します。  

2.  定義する追加の探索スコープごとに、上記の手順を繰り返します。  

3.  **[ポーリングのスケジュール]** タブで、完全な探索ポーリングのスケジュールと差分探索の両方を構成します。  

4.  **[オプション]** タブで、探索から古いコンピューターのレコードをフィルタリングして取り除く、つまり除外するように設定を構成します。 また、配布グループのメンバーシップの探索も構成します。  

    > [!NOTE]  
    >  既定では、Active Directory グループの探索では、セキュリティ グループのメンバーシップのみ探索されます。  

5. **[OK]** を選択して構成を保存します。  


### <a name="bkmk_config-adsd"></a> Active Directory システムの探索を構成する  

1. Active Directory システム探索の [プロパティ] ウィンドウの **[全般]** タブで、**[新規]** アイコン ![新規アイコン](media/Disc_new_Icon.gif) を選択して、新しい Active Directory コンテナーを指定します。 **[Active Directory コンテナー]** ダイアログ ボックスで、次の構成を完了します。  

    1.  **パス**への場所を入力するか、または参照します。 この値は、コンテナーまたは組織単位 (OU) に対する有効な LDAP パスです。 サイトでは、リソースのためにこのパスを照会します。 たとえば、`LDAP://CN=Computers,DC=contoso,DC=com` などです。  

    2.  検索動作を変更するオプションを指定します。  

        - **[Active Directory グループ内でオブジェクトを探索する]**: サイトでは、このパスにあるグループのメンバーシップも確認します。  

        - **[Active Directory の子コンテナーを反復検索する]**: このオプションを有効にした場合、サイトは上記のパス内で追加のコンテナーや OU を検索します このオプションを無効にした場合、サイトは特定のパスにあるリソースのみを検索します。  

            バージョン 1806 以降では、この反復検索から除外するサブコンテナーを選択します。 このオプションは、検出されるオブジェクトの数を絞り込むのに役立ちます。 **[追加]** を選択して、上記のパスにあるコンテナーを選択します。 [新しいコンテナーの選択] ダイアログ ボックスで、除外する子コンテナーを選択します。 **[OK]** を選択し、[新しいコンテナーの選択] ダイアログ ボックスを閉じます。<!--1358143-->

            > [!Tip]  
            > Active Directory システム探索の [プロパティ] ウィンドウにある Active Directory コンテナーの一覧には、**[Has Exclusions]** \(除外する\) 列が含まれています。 除外するコンテナーを選択した場合、この値は **[はい]** になります。  

    3.  場所ごとに、**[Active Directory 探索アカウント]** として使用するアカウントを指定します。 詳細については、[アカウント](/sccm/core/plan-design/hierarchy/accounts#active-directory-system-discovery-account)に関するページを参照してください。  

        > [!TIP]  
        >  指定した場所ごとに、探索オプションのセットおよび一意の Active Directory 探索アカウントを構成できます。  

    4.  **[OK]** を選択して Active Directory コンテナーの構成を保存します。  

2.  **[ポーリングのスケジュール]** タブで、完全な探索ポーリングのスケジュールと差分探索の両方を構成します。  

3.  **[Active Directory の属性]** タブで、探索するコンピューターの追加の Active Directory 属性を構成します。 このタブには、既定のオブジェクト属性が表示されます。  

     > [!Tip]  
     > たとえば、組織が Active Directory のコンピューター アカウントの **Description** 属性を使用します。 **[カスタム]** を選択し、カスタム属性として `Description` を追加します。 この探索方法の実行後、この属性は、Configuration Manager コンソールでデバイスの [プロパティ] タブに表示されます。<!--513948-->  

4.  **[オプション]** タブで、探索から古いコンピューターのレコードをフィルタリングして取り除く、つまり除外するように設定を構成します。  

5. **[OK]** を選択して構成を保存します。  


### <a name="bkmk_config-adud"></a> Active Directory ユーザーの探索を構成する  

1.  Active Directory ユーザー探索の [プロパティ] ウィンドウの **[全般]** タブで、**[新規]** アイコン ![新規アイコン](media/Disc_new_Icon.gif) を選択して、新しい Active Directory コンテナーを指定します。 **[Active Directory コンテナー]** ダイアログ ボックスで、次の構成を完了します。  

    1.  検索する 1 つまたは複数の場所を指定します。  

    2.  場所ごとに、検索動作を変更するオプションを指定します。  

    3.  場所ごとに、**[Active Directory 探索アカウント]** として使用するアカウントを指定します。 詳細については、[アカウント](/sccm/core/plan-design/hierarchy/accounts#active-directory-user-discovery-account)に関するページを参照してください。  

        > [!NOTE]  
        >  指定した場所ごとに、探索オプションの一意のセットおよび一意の Active Directory 探索アカウントを構成できます。  

    4.  **[OK]** を選択して Active Directory コンテナーの構成を保存します。  

6.  **[ポーリングのスケジュール]** タブで、完全な探索ポーリングのスケジュールと差分探索の両方を構成します。  

7.  **[Active Directory の属性]** タブで、探索するコンピューターの追加の Active Directory 属性を構成します。 このタブには、既定のオブジェクト属性が表示されます。  

8.  **[OK]** を選択して構成を保存します。  



## <a name="azureaadisc"></a> Azure AD ユーザー探索を構成する

Azure AD ユーザー探索は、他の探索方法と同じように、有効にしたり構成することはできません。 Configuration Manager サイトを Azure AD にオンボードする際に構成します。 **クラウド管理**用に [Azure サービスを構成する](/sccm/core/servers/deploy/configure/azure-services-wizard)場合も、この探索方法を有効にして構成することができます。 

**クラウド管理** Azure サービスを構成する場合は、次の手順を実行します。 
- ウィザードの **[検出]** ページで、**[Azure Active Directory ユーザーの探索を有効にする]** オプションをクリックします。 
- **[設定]** を選択します。 
- [Azure AD ユーザー探索設定] ダイアログ ボックスで、検出を実行するスケジュールを設定します。 Azure AD の新規または変更されたアカウントのみをチェックする差分探索を有効にすることもできます。 

詳細については、「[Azure AD ユーザー探索](/sccm/core/servers/deploy/configure/about-discovery-methods#azureaddisc)」を参照してください。

 > [!Important]  
 > Azure AD アプリを Configuration Manager に*インポート*する前に、Azure AD からディレクトリ データを読み取るためにサーバー アプリケーションのアクセス許可を付与する必要があります。 
 >  - [Azure Portal](https://portal.azure.com) で、**[Azure Active Directory]** ブレードに移動します。 
 >  - **[アプリの登録]** を選択して、必要に応じて **[すべてのアプリ]** に切り替えます。 
 >  - サーバー アプリの種類 *[Web アプリ/API]* を選択して、**[設定]** を選択します。 
 >  - **[必要なアクセス許可]** を選択してから、**[アクセス許可の付与]** を選択します。
 >  
 > Configuration Manager からサーバー アプリを*作成*すると、Azure AD がアプリケーションを使用してアクセス許可を自動的に作成します。 その場合も、Azure Portal でアプリケーションに同意する必要があります。

 > [!Note]  
 > ユーザーがフェデレーション ID または同期 ID である場合、Azure AD ユーザー探索だけでなく、Configuration Manager の [Active Directory ユーザー探索](/sccm/core/servers/deploy/configure/about-discovery-methods#bkmk_aboutUser)を使用する必要があります。 ハイブリッド ID の詳細については、「[ハイブリッド ID 導入戦略の定義](/azure/active-directory/active-directory-hybrid-identity-design-considerations-identity-adoption-strategy)」を参照してください。<!--497750-->



##  <a name="BKMK_ConfigHBDisc"></a> 定期探索の構成  

プライマリ サイトをインストールすると、Configuration Manager は定期探索を有効にします。 7 日おきの既定のスケジュールを使用する場合は、他の構成作業は必要ありません。 既定のスケジュールを使用しない場合は、クライアントが管理ポイントに定期探索データ レコードを送信する頻度のスケジュールを構成する作業だけが必要になります。  

> [!NOTE]  
>  同じサイトで、クライアント プッシュ インストールおよび **[インストール フラグのクリア]** のサイト メンテナンス タスクの両方が有効な場合、定期探索のスケジュールを、**[インストール フラグのクリア]** サイト メンテナンス タスクの **[クライアント再探索期間]** より小さく設定します。 サイトのメンテナンス タスクの詳細については、[メンテナンス タスク](/sccm/core/servers/manage/maintenance-tasks)に関するページを参照してください。  


### <a name="configure-the-heartbeat-discovery-schedule"></a>定期探索スケジュールを構成する  

1.  Configuration Manager コンソールで **[管理]** ワークスペースに移動し、**[階層の構成]** を展開して、**[探索方法]** ノードを選択します。  

2.  定期探索を構成するサイトの **[定期探索]** を選択します。  

3.  リボンの **[ホーム]** タブの **[プロパティ]** グループで、**[プロパティ]** を選択します。  

4.  クライアントが定期探索データ レコードを送信する頻度を構成します。 次に、**[OK]** を選択して構成を保存します。  



<a name="BKMK_AboutConfigNetworkDisc"></a>

##  <a name="BKMK_ConfigNetworkDisc"></a> ネットワーク探索の構成  

 ネットワーク探索を構成する前に、次のトピックについて把握しておきます。  

-   利用可能なレベルのネットワーク探索  

-   利用できるネットワーク探索オプション  

-   ネットワークにおけるネットワーク探索の制限  

詳細については、「[ネットワーク探索について](/sccm/core/servers/deploy/configure/about-discovery-methods#bkmk_aboutNetwork)」を参照してください。  

以下のセクションでは、ネットワーク探索の一般的な構成について説明します。 同じ探索を実行するときに使用するように、これらの構成の 1 つまたは複数を構成できます。 複数の構成を使用する場合、探索結果に影響する可能性がある処理を計画します。  

たとえば、特定の SNMP コミュニティ名を使用するすべての簡易ネットワーク管理プロトコル (SNMP) デバイスを探索します。 同じ探索を実行する際に、特定のサブネットでの探索を無効にします。 探索の実行時に、ネットワーク探索では、無効になっているサブネットで指定のコミュニティ名を持つ SNMP デバイスは探索されません。  


###  <a name="BKMK_DetermineNetTopology"></a> ネットワーク トポロジの確認  

 トポロジのみの探索を使用してネットワークをマップできます。 この種の探索では、存在する可能性があるクライアントは探索されません。 トポロジのみのネットワーク探索では、SNMP が使用されます。  

 ネットワーク トポロジをマップする場合、**[ネットワーク探索のプロパティ]** ダイアログ ボックスの **[SNMP]** タブで、**[最大ホップ数]** を構成します。 わずか数ホップで、探索の実行時に使用されるネットワーク帯域幅を制御できます。 探索するネットワークが増えるにつれて、ホップ数を増やすと、ネットワーク トポロジへの理解が深まります。  

 ネットワーク トポロジを理解した後は、ネットワーク探索の追加のプロパティを構成します。 これらのプロパティは、潜在的なクライアントとオペレーティング システムを検出するのに役立ちます。 また、検索できるネットワーク セグメントを制限するように、ネットワーク探索を構成します。  

 詳細については、「[ネットワーク トポロジの決定方法](#bkmk_proc-top)」を参照してください。


### <a name="network-discovery-search-options"></a>ネットワーク探索の検索オプション

Configuration Manager では、ネットワークを検索する次の方法をサポートします。
- [ サブネットを使用した検索の制限](#BKMK_LimitBySubnet)
- [ 特定のドメインの検索](#BKMK_SearchByDomain)
- [ SNMP コミュニティ名を使用した検索の制限](#BKMK_LimitBySNMPname)
- [ 特定の DHCP サーバーの検索](#BKMK_SearchByDHCP)

####  <a name="BKMK_LimitBySubnet"></a> サブネットを使用した検索の制限  

 探索の実行中に特定のサブネットを検索するように、ネットワーク探索を構成できます。 既定では、ネットワーク探索では、探索を実行しているサーバーのサブネットが検索されます。 構成して有効にした追加のサブネットは、SNMP 検索オプションおよび DHCP 検索オプションにのみ適用されます。 ネットワーク探索でドメインを検索する場合、サブネットの構成によって検索が制限されることはありません。  

 **[ネットワーク探索のプロパティ]** ダイアログ ボックスの **[サブネット]** タブで、1 つまたは複数のサブネットを指定する場合、**[有効]** とマークされているサブネットのみが検索されます。  

 サブネットを無効にすると、サイトはそのサブネットを探索から除外し、次の条件が適用されます。  

-   SNMP ベースのクエリは、そのサブネットで実行されません。  

-   DHCP サーバーは、そのサブネットに配置されたリソースの一覧では応答しません。  

-   ドメイン ベースのクエリで、そのサブネットに配置されたリソースを探索できます。  


####  <a name="BKMK_SearchByDomain"></a> 特定のドメインの検索  

 探索の実行中に特定ドメインまたはドメインのセットを検索するように、ネットワーク探索を構成できます。 既定では、ネットワーク探索では、探索を実行しているサーバーのローカル ドメインが検索されます。  

 **[ネットワーク探索のプロパティ]** ダイアログ ボックスの **[ドメイン]** タブで、1 つまたは複数のドメインを指定する場合、**[有効]** とマークされているドメインのみが検索されます。  

 ドメインを無効にすると、サイトはそのドメインを探索から除外し、次の条件が適用されます。  

-   ネットワーク探索で、そのドメイン内のドメイン コントローラーは照会されません。  

-   SNMP ベースのクエリは、そのドメイン内のサブネットで引き続き実行できます。  

-   DHCP サーバーは、そのドメイン内に配置されたリソースの一覧で引き続き応答できます。  


#### <a name="BKMK_LimitBySNMPname"></a> SNMP コミュニティ名を使用した検索の制限  

 探索の実行中に特定の SNMP コミュニティまたはコミュニティのセットを検索するように、ネットワーク探索を構成できます。 既定では、メソッドは **public** というコミュニティ名を構成します。  

 ネットワーク探索は、コミュニティ名を使用して、SNMP デバイスになっているルーターへのアクセスを取得します。 ルーターは、最初のルーターにリンクされている他のルーターやサブネットに関する情報をネットワーク探索に提供できます。  

> [!NOTE]  
>  SNMP コミュニティ名は、パスワードのようなものです。 ネットワーク探索では、コミュニティ名を指定された SNMP デバイスからのみ情報を取得できます。 各 SNMP デバイスは独自のコミュニティ名を持つことができますが、多くの場合は複数のデバイスで同じコミュニティ名が共有されます。 また、ほとんどの SNMP デバイスは、既定の **public** というコミュニティ名を使用します。  ただし、セキュリティ上の理由から、デバイスから **public** というコミュニティ名を削除している組織もあります。  

 **[ネットワーク探索のプロパティ]** ダイアログ ボックスの **[SNMP]** タブに複数の SNMP コミュニティが含まれる場合、表示されている順序で検索を行います。 最もよく使用される名前が、常に一覧の最上位に配置されています。 この構成によって、別の名前を使用してデバイスへの接続を試行した場合に、サイトが生成するネットワーク トラフィックを最小限に抑えることができます。

> [!NOTE]  
>  SNMP コミュニティ名を使用できるだけでなく、特定の SNMP デバイスの IP アドレスまたは解決可能な名前も指定できます。 このアクションは、**[ネットワーク探索のプロパティ]** ダイアログ ボックスの **[SNMP デバイス]** タブで行います。  


####  <a name="BKMK_SearchByDHCP"></a> 特定の DHCP サーバーの検索  

 特定の DHCP サーバーまたは複数のサーバーを使用して探索の実行中に DHCP クライアントを探索するように、ネットワーク探索を構成できます。  

 ネットワーク探索は、**[ネットワーク探索のプロパティ]** ダイアログ ボックスの **[DHCP]** タブで指定する各 DHCP サーバーを検索します。 探索を実行しているサーバーが DHCP サーバーから IP アドレスをリースしている場合は、その DHCP サーバーを検索するように探索を構成できます。 **[Include the DHCP server that the site server is configured to use]** \(サイトのサーバーで使用するように構成された DHCP サーバーを含める\) オプションを使用して、この動作を有効にします。  

> [!NOTE]  
>  ネットワーク探索時に使用する DHCP サーバーを構成するには、環境で IPv4 をサポートしている必要があります。 ネイティブの IPv6 環境で、ネットワーク探索時に使用する DHCP サーバーを構成することはできません。  


###  <a name="BKMK_HowToConfigNetDisc"></a> ネットワーク探索の構成方法  

 次の手順に従って、まずネットワーク トポロジのみ探索します。次に、1 つまたは複数の使用可能なネットワーク探索オプションを使用して、存在する可能性があるクライアントを探索するようにネットワーク探索を構成します。  

#### <a name="bkmk_proc-top"></a> ネットワーク トポロジの決定方法  

1.  Configuration Manager コンソールで **[管理]** ワークスペースに移動し、**[階層の構成]** を展開して、**[探索方法]** ノードを選択します。  

2.  ネットワーク リソースを探索するサイトの **[ネットワーク探索]** 方法を選択します。  

3.  リボンの **[ホーム]** タブの **[プロパティ]** グループで、**[プロパティ]** を選択します。  

    -   **[全般]** タブで、**[ネットワーク探索を有効にする]** オプションを選択します。 次に、**[探索の種類]** オプションから **[トポロジ]** を選択します。  

    -   **[サブネット]** タブで、**[ローカル サブネットを探索]** オプションを選択します。  

        > [!TIP]  
        >  ネットワークを構成している特定のサブネットがわかっている場合は、**[ローカル サブネットを検索する]** チェック ボックスをオフにします。 次に、**[新規]** アイコン ![新規アイコン](media/Disc_new_Icon.gif) を選択して、検索する特定のサブネットを追加します。 大規模なネットワークの場合、サブネットを一度に 1 つまたは 2 つだけ検索して、ネットワーク帯域幅の使用を最小限に抑えます。  

    -   **[ドメイン]** タブで、**[ローカル ドメインを検索]** オプションを選択します。  

    -   **[SNMP]** タブで、**[最大ホップ数]** ドロップダウン リストから 1 つのオプションを選択します。 このオプションでは、トポロジのマッピングでネットワーク探索が利用できるルーター ホップ数を指定します。  

        > [!TIP]  
        >  ネットワーク トポロジの初回マップ時には、ネットワーク帯域幅の使用を最小限に抑えるため、ごくわずかな数のルーター ホップを構成します。  

4.  **[スケジュール]** タブで、**[新規]** アイコン ![新規アイコン](media/Disc_new_Icon.gif) を選択して、探索の実行スケジュールを設定します。  

    > [!NOTE]  
    >  複数の探索構成を、ネットワーク探索のスケジュールを分けるように割り当てることはできません。 ネットワーク探索の実行時は毎回、現在の探索構成が使用されます。  

5.  **[OK]** を選択して、構成を受け入れます。 ネットワーク探索が、スケジュールされた時刻に実行されます。  


#### <a name="bkmk_proc-config"></a> ネットワーク探索の構成方法  

1.  Configuration Manager コンソールで **[管理]** ワークスペースに移動し、**[階層の構成]** を展開して、**[探索方法]** ノードを選択します。  

2.  ネットワーク リソースを探索するサイトの **[ネットワーク探索]** 方法を選択します。  

3.  リボンの **[ホーム]** タブの **[プロパティ]** グループで、**[プロパティ]** を選択します。  

4.  **[全般]** タブで、**[ネットワーク探索を有効にする]** オプションを選択します。  

    - **[探索の種類]** オプションから、実行する探索の種類を選択します。  

    - Configuration Manager が低帯域幅のネットワークに対して自動調整を行うように、**[低速のネットワーク]** オプションを有効にします。  

5.  サブネットを検索するように探索を構成するには、**[サブネット]** タブに切り替えます。次に、以下のオプションのうち、1 つまたは複数を構成します。  

    -   探索を実行するコンピューターのローカルのサブネットで探索を実行するには、**[ローカル サブネットを検索する]** オプションを有効にします。  

    -   特定のサブネットを検索するには、サブネットが **[検索するサブネット]** に表示され、**[検索]** の値が **[有効]** になっていることを確認します。  

        1.  サブネットが一覧に表示されていない場合、**[新規]** アイコン ![新規アイコン](media/Disc_new_Icon.gif) を選択します。 **[新しいサブネットの割り当て]** ダイアログ ボックスに、**[サブネット]** と **[マスク]** の情報を入力して、**[OK]** を選択します。 既定では、新しいサブネットの検索が有効になります。  

        2.  一覧に示されたサブネットの **[検索]** の値を変更するには、一覧から該当の値を選択します。 次に、**[切り替え]** アイコンを選択して、**[無効]** と **[有効]** のいずれかに値を切り替えます。  

6.  ドメインを検索するように探索を構成するには、**[ドメイン]** タブに切り替えます。次に、以下のオプションのうち、1 つまたは複数を構成します。  

    -   探索を実行するコンピューターのドメイン上で探索を実行するには、**[ローカル ドメインを検索する]** オプションを有効にします。  

    -   特定のドメインを検索するには、ドメインが **[ドメイン]** に表示され、**[検索]** の値が **[有効]** になっていることを確認します。  

        1.  ドメインが一覧に表示されていない場合、**[新規]** アイコン ![新規アイコン](media/Disc_new_Icon.gif) を選択します。 **[ドメインのプロパティ]** ダイアログ ボックスで、**ドメイン**の情報を入力し、**[OK]** を選択します。 既定では、新しいドメインの検索が有効になります。  

        2.  一覧に示されたドメインの **[検索]** の値を変更するには、一覧から該当の値を選択します。 次に、**[切り替え]** アイコンを選択して、**[無効]** と **[有効]** のいずれかに値を切り替えます。  

7.  SNMP デバイスの特定の SNMP コミュニティ名を検索するように探索を構成するには、**[SNMP]** タブに切り替えます。次に、以下のオプションのうち、1 つまたは複数を構成します。  

    - **[SNMP コミュニティ名]** の一覧に SNMP コミュニティ名を追加するには、**[新規]** アイコン ![新規アイコン](media/Disc_new_Icon.gif) を選択します。 検索するコミュニティの名前を **[新しい SNMP コミュニティ名]** ダイアログ ボックスで、SNMP コミュニティの**名前**を指定し、**[OK]** を選択します。  

    - SNMP コミュニティ名を削除するには、コミュニティ名を選択して、**[削除]** アイコン ![[削除] アイコン](media/Disc_delete_Icon.gif) をクリックします。  

    - SNMP コミュニティ名の検索順序を調整するには、一覧からコミュニティ名を選択します。 次に、**[Move Item Up]** \(項目を上へ移動\) アイコン ![項目を上へ移動アイコン](media/Disc_moveUp_Icon.gif) または **[Move Item Down]** \(項目を下へ移動\) アイコン ![項目を下へ移動アイコン](media/Disc_moveDown_Icon.gif) を選択します。 探索の実行時に、上から下の順番でコミュニティ名が検索されます。 

    - SNMP 検索で使用するルーター ホップの最大数を構成するには、**[最大ホップ数]** ドロップダウン リストからホップの数を選択します。  

8. SNMP デバイスを構成するには、**[SNMP デバイス]** タブに切り替えます。デバイスが一覧に表示されていない場合、**[新規]** アイコン ![新規アイコン](media/Disc_new_Icon.gif) を選択します。 **[新しい SNMP デバイス]** ダイアログ ボックスで、SNMP デバイスの IP アドレスまたはデバイス名を指定し、**[OK]** を選択します。  

    > [!NOTE]  
    >  デバイス名を指定する場合、Configuration Manager が NetBIOS 名を IP アドレスに解決できる必要があります。  

9. 特定の DHCP サーバーを照会するように探索を構成するには、**[DHCP]** タブに切り替えます。次に、以下のオプションのうち、1 つまたは複数を構成します。  

    -   探索を実行しているコンピューターで DHCP サーバーを照会するには、**[サイト サーバーの DHCP サーバーを常に使用する]** オプションを有効にします。  

        > [!NOTE]  
        >  このオプションを使用するには、サーバーが DHCP サーバーから IP アドレスをリースしている必要があります。また、静的 IP アドレスは使用できません。  

    -   特定の DHCP サーバーを照会するには、**[新規]** アイコン ![新規アイコン](media/Disc_new_Icon.gif) を選択します。 **[新しい DHCP サーバー]** ダイアログ ボックスで DHCP サーバーの IP アドレスまたはサーバー名を指定し、**[OK]** を選択します。  

        > [!NOTE]  
        >  サーバー名を指定する場合、Configuration Manager が NetBIOS 名を IP アドレスに解決できる必要があります。  

10. 探索の実行タイミングを構成するには、**[スケジュール]** タブに切り替えます。**[新規]** アイコン ![新規アイコン](media/Disc_new_Icon.gif) を選択して、ネットワーク探索の実行スケジュールを設定します。 複数の定期スケジュールや、繰り返しパターンのない複数のスケジュールなど、さまざまなスケジュールを構成できます。  

    > [!NOTE]  
    >  **[スケジュール]** タブに複数のスケジュールが同時に表示される場合、スケジュールに示されている時刻に構成されているとおりに、すべてのスケジュールでネットワーク探索が実行されます。 この動作は定期スケジュールにも当てはまります。  

11. **[OK]** を選択して構成を保存します。  


###  <a name="BKMK_HowToVerifyNetDisc"></a> ネットワーク探索の終了を確認する方法  

 ネットワーク検索が完了するのに必要な時間は、次の 1 つ以上の要因によって異なります。  

-   ネットワークの規模  

-   ネットワークのトポロジー  

-   ネットワーク上のルーターを検出するように構成されているホップの最大数  

-   実行される探索の種類  

ネットワーク探索では、終了時に、終了を通知するメッセージは作成されません。 次の手順を使用して、探索がいつ終了したかを確認します。  

1.  Configuration Manager コンソールで、**[監視]** ワークスペースに移動します。 **[システム ステータス]** を展開して、**[ステータス メッセージ クエリ]** ノードを選択します。  

2.  **[すべてのステータス メッセージ]** クエリを選択します。  

3.  リボンの **[ホーム]** タブの **[ステータス メッセージ クエリ]** グループで、**[メッセージを表示する]** を選択します。  

4.  [すべてのステータス メッセージ] ウィンドウで、**[日時の選択]** ドロップダウン リストから、探索が開始された時点を含む値を選択します。 次に、**[OK]** を選択して、**[Configuration Manager ステータス メッセージ ビューアー]** を開きます。  

    > [!TIP]  
    >  **[日時の選択]** オプションを使用して、探索を実行した日時を指定することもできます。 このオプションは、指定した日にネットワーク探索を実行し、その日のメッセージのみを取得したい場合に便利です。  

5.  ネットワーク探索が終了したことを確認するには、次の情報が含まれたステータス メッセージを検索します。  

    -   メッセージ ID : **502**  

    -   コンポーネント : **SMS_NETWORK_DISCOVERY**  

    -   説明: **このコンポーネントは停止しました。**  

    このステータス メッセージが表示されない場合は、ネットワーク探索は終了していません。  

7.  ネットワーク探索が開始したことを確認するには、次の情報が含まれたステータス メッセージを検索します。  

    -   メッセージ ID : **500**  

    -   コンポーネント : **SMS_NETWORK_DISCOVERY**  

    -   説明: **このコンポーネントが開始しました。**  

    この情報は、ネットワーク探索が開始したことを確認するものです。 この情報が表示されない場合は、ネットワーク探索のスケジュールを変更します。  

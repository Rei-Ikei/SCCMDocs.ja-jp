---
title: タスク シーケンス組み込み変数
titleSuffix: Configuration Manager
description: タスク シーケンス組み込み変数は、タスク シーケンスが実行されている環境に関する情報を提供し、その値は、タスク シーケンス全体で使用できます。
ms.date: 04/18/2018
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: conceptual
ms.assetid: 02bc6bd4-ca53-4e22-8b80-d8ee5fe72567
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: d3ea1b35c5f220155cecafddaf3a2ff1acf5ed53
ms.sourcegitcommit: 0b0c2735c4ed822731ae069b4cc1380e89e78933
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/03/2018
---
# <a name="task-sequence-built-in-variables-in-system-center-configuration-manager"></a>System Center Configuration Manager のタスク シーケンス組み込み変数

*適用対象: System Center Configuration Manager (Current Branch)*


 タスク シーケンス組み込み変数は、System Center Configuration Manager によって提供されます。 組み込み変数は、タスク シーケンスが実行されている環境に関する情報を提供し、その値は、タスク シーケンス全体を通じて使用できます。 通常、組み込み変数はタスク シーケンス内で最初のステップが実行される前に初期化されます。 たとえば、組み込み変数 **_SMSTSLogPath** は、Configuration Manager コンポーネントがログ ファイルの書き込みに使用するパスを指定する環境変数です。 この環境変数には、すべてのタスク シーケンス ステップからアクセスできます。 ただし、タスク シーケンスでは、**&#95;SMSTSCurrentActionName** などの一部の変数が各ステップの前に評価されます。 アンダースコアで始まる名前を持つ組み込み変数の値は読み取り専用です。  

## <a name="task-sequence-built-in-variable-list"></a>タスク シーケンス組み込み変数の一覧  
 次の一覧では Configuration Manager で利用できる組み込み変数について説明します。  

|組み込み変数名|説明|  
|-----------------------------|-----------------|  
|_OSDDetectedWinDir|Windows PE の起動時に、タスク シーケンスでコンピューターのハード ドライブの以前のオペレーティング システムのインストールがスキャンされます。 Windows フォルダーの場所は、この変数に格納されます。 タスク シーケンスを構成して、環境からこの値を取得して使用し、新しいオペレーティング システムのインストールに使用する同じ Windows フォルダーの場所を指定できます。|  
|_OSDDetectedWinDrive|Windows PE の起動時に、タスク シーケンスでコンピューターのハード ドライブの以前のオペレーティング システムのインストールがスキャンされます。 オペレーティング システムがインストールされるハード ドライブの場所は、この変数に格納されます。 タスク シーケンスを構成して、環境からこの値を取得して使用し、新しいオペレーティング システムに使用する同じハード ドライブの場所を指定できます。|  
|_SMSTSAdvertID|現在実行中のタスク シーケンスの一意の ID を格納します。 Configuration Manager のソフトウェア配布展開 ID と同じフォーマットを使用します。 タスク シーケンスがスタンドアロン メディアから実行されている場合は、この変数は未定義になります。<br /><br /> 例:<br /><br /> **ABC20001**|  
|_TSAppInstallStatus|タスク シーケンスで、_TSAppInstallStatus 変数に [[アプリケーションのインストール]](task-sequence-steps.md#BKMK_InstallApplication) ステップでのアプリケーションのインストール ステータスが設定されます。 タスク シーケンスによって、この変数に次のいずれかの値が設定されます。<br /><br /> 1.**未定義**: [アプリケーションのインストール] ステップは実行されていません。<br />2.**エラー**: [アプリケーションのインストール] ステップで、エラーのために少なくとも 1 つのアプリケーションが失敗しました。<br />3.**警告**: [アプリケーションのインストール] ステップでエラーは発生していません。 要件が満たされなかったため、1 つ以上のアプリケーション、または必要な依存関係がインストールされませんでした。<br />4.**成功**: [アプリケーションのインストール] ステップで、エラーや警告は検出されていません。|  
|_SMSTSBootImageID|現在実行中のタスク シーケンスでブート イメージ パッケージを参照する場合は、この変数でブート イメージ パッケージ ID が格納されます。 タスク シーケンスでブート イメージ パッケージを参照しない場合、この変数は設定されません。<br /><br /> 例:<br /><br /> **ABC00001**|  
|_SMSTSBootUEFI|タスク シーケンスが UEFI モードで起動するコンピューターを検出した場合に、SMSTSBootUEFI 変数を設定します。|  
|_SMSTSClientGUID|Configuration Manager クライアント GUID の値を格納します。 タスク シーケンスがスタンドアロン メディアから実行されている場合、この変数は設定されません。<br /><br /> 例:<br /><br /> **0a1a9a4b-fc56-44f6-b7cd-c3f8ee37c04c**|  
|_SMSTSCurrentActionName|現在実行中のタスク シーケンス ステップの名前です。 この変数は、タスク シーケンス マネージャーが個々のステップを実行する前に設定されます。<br /><br /> 例:<br /><br /> **コマンド ラインの実行**|  
|_SMSTSDownloadOnDemand|現在のタスク シーケンスがオン デマンド ダウンロード モードで実行されている場合、この変数は **true** です。 オン デマンド ダウンロード モードでは、コンテンツへのアクセスが必要になった場合にのみ、タスク シーケンス マネージャーがコンテンツをローカルにダウンロードします。|  
|_SMSTSInWinPE|現在のタスク シーケンス ステップが Windows PE で実行されている場合、この変数は **true** です。 このタスク シーケンス変数をテストして、現在のオペレーティング システム環境を特定します。|  
|_SMSTSLastActionRetCode|最後に実行されたアクションが返したリターン コードを格納します。 この変数は、次の手順が実行されるかどうかを決定するための条件として使用できます。<br /><br /> 例:<br /><br /> **0**|  
|_SMSTSLastActionSucceeded|最後のステップが成功した場合、この変数は **true** です。 最後のステップが失敗した場合は **false** です。 ステップが無効になっているか、関連する条件が **false** に評価されたためにタスク シーケンスで最後のアクションがスキップされた場合、この変数はリセットされません。 引き続き、前のアクションの値が保持されます。|  
|_SMSTSLaunchMode|次のタスク シーケンスの起動方法のいずれかを指定します。<br /><br /> -   **SMS**: タスク シーケンスは Configuration Manager クライアントから起動されます<br />-   **UFD**: タスク シーケンスはレガシ USB メディアから起動されます<br />-   **UFD+FORMAT**: タスク シーケンスは新しい USB メディアから起動されます<br />-   **CD**: タスク シーケンスは CD から起動されます<br />-   **DVD**: タスク シーケンスは DVD から起動されます<br />-   **PXE**: タスク シーケンスは PXE から起動されます<br />-   **HD**: タスク シーケンスはハード ディスク上の事前設定済みメディアから起動されます|  
|_SMSTSLogPath|ログ ディレクトリへの完全なパスを格納します。 この値を使用して、アクションが記録される場所を特定します。 ハード ドライブが利用できない場合、この値は設定されません。|  
|_SMSTSMachineName|コンピューター名を格納します。 タスク シーケンスですべてのステータス メッセージを記録するために使用するコンピューターの名前を格納します。 新しいオペレーティング システムで使用するコンピューター名を変更するには、 **OSDComputerName** 変数を使用します。<br /><br /> 例:<br /><br /> **ABC**|  
|_SMSTSMDataPath|SMSTSLocalDataDrive の値が定義するパスを指定します。 コレクション変数の設定などのように、タスク シーケンスが起動する前に SMSTSLocalDataDrive を定義すると、Configuration Manager はそのタスク シーケンスが起動された後で _SMSTSMDataPath 値を定義します。|  
|_SMSTSMediaType|インストールを開始するために使用するメディアの種類を指定します。 メディアの種類の例としては、ブート メディア、フル メディア、PXE、事前設定されたメディアなどがあります。|  
|_SMSTSMP|Configuration Manager の管理ポイントの URL または IP アドレスを格納します。|  
|_SMSTSMPPort|Configuration Manager の管理ポイントの管理ポイント ポート番号を格納します。<br /><br /> 例:<br /><br /> **80**|  
|_SMSTSOrgName|タスク シーケンスの進行状況ダイアログに表示されるブランド タイトル名を格納します。<br /><br /> 例:<br /><br /> **XYZ 社**|  
|_SMSTSOSUpgradeActionReturnCode|Windows セットアップで返される終了コード値 (成功または失敗を示す値) を格納します。 この変数は、[[オペレーティング システムのアップグレード]](task-sequence-steps.md#BKMK_UpgradeOS) タスク シーケンス ステップ中に設定されます。 この変数は、/Compat コマンド ライン オプションで使用すると便利です。<br /><br /> 例:<br /><br /> /Compat が完了したら、終了コードが失敗か成功かに応じて、以降のステップでアクションを実行します。 成功の場合は、アップグレードを開始します。 または、環境にマーカーを設定し (たとえば、ファイルを追加したり、レジストリ キーを設定したりして)、ハードウェア インベントリで収集します。 このマーカーを使用して、アップグレードの準備ができているコンピューターや、アップグレード前にアクションが必要なコンピューターのコレクションを作成します。|  
|_SMSTSPackageID|現在実行中のタスク シーケンス ID を格納します。 この ID では Configuration Manager のソフトウェア パッケージ ID と同じ形式が使用されます。<br /><br /> 例:<br /><br /> **HJT00001**|  
|_SMSTSPackageName|現在実行中のタスク シーケンスの作成時に Configuration Manager 管理者によって指定されたタスク シーケンス名を格納します。<br /><br /> 例:<br /><br /> **Windows 10 タスク シーケンスの展開**|  
|_SMSTSSetupRollback|オペレーティング システムのセットアップでロールバック操作が実行されたかどうかを指定します。 変数の値には **true** または **false**を使用できます。|  
|_SMSTSRunFromDP|現在のタスク シーケンスが配布ポイントからの実行モードで実行されている場合は **TRUE** に設定されます。このモードでは、タスク シーケンス マネージャーは、配布ポイントから必要なパッケージ共有を取得します。|  
|_SMSTSSiteCode|Configuration Manager サイトのサイト コードを格納します。<br /><br /> 例:<br /><br /> **ABC**|  
|_SMSTSType|現在実行中のタスク シーケンスの種類です。 次の値のいずれかを取ります。<br /><br /> **1** - 一般タスク シーケンスを示します。<br /><br /> **2** - オペレーティング システムの展開タスク シーケンスを示します。|  
|_SMSTSTimezone|タイム ゾーン情報を次の形式で (スペースなしで) 格納します。<br /><br /> Bias, StandardBias, DaylightBias, StandardDate.wYear, wMonth, wDayOfWeek, wDay, wHour, wMinute, wSecond, wMilliseconds, DaylightDate.wYear, wMonth, wDayOfWeek, wDay, wHour, wMinute, wSecond, wMilliseconds, StandardName, DaylightName<br /><br /> 例:<br /><br /> 米国およびカナダ東部標準時の場合、この値は **300,0,-60,0,11,0,1,2,0,0,0,0,3,0,2,2,0,0,0,Eastern Standard Time,Eastern Daylight Time**となります。|  
|_SMSTSUseCRL|タスク シーケンスで管理ポイントとの通信に HTTPS を使用する場合に、証明書失効リスト (CRL) を使用するかどうかを指定します。|  
|_SMSTSUserStarted|タスク シーケンスがユーザーによって開始されたかどうかを示します。 この変数は、タスク シーケンスがソフトウェア センターから開始された場合のみ設定されます。 たとえば、 **_SMSTSLaunchMode** が **SMS**に設定されている場合などです。 この変数は次の値のいずれかを取ります。<br /><br /> -   **TRUE** - タスク シーケンスがユーザーによってソフトウェア センターから手動で開始されたことを示します。<br />-   **false** - タスク シーケンスが Configuration Manager スケジューラによって自動的に開始されたことを示します。|  
|_SMSTSUseSSL|タスク シーケンスが Configuration Manager 管理ポイントとの通信に SSL を使用するかどうかを表します。 サイトがネイティブ モードで実行されている場合、値は **TRUE**に設定されます。|  
|_SMSTSWTG|コンピューターが Windows To Go デバイスとして動作しているかどうかを指定します。|  
|OSDPreserveDriveLetter|このタスク シーケンス変数は非推奨とされます。 既定では、オペレーティング システムの展開中に、Windows セットアップが、使用する最適なドライブ文字を決定します (通常は C:)。 <br /><br />以前の動作: イメージの適用時に、OSDPreverveDriveLetter 変数で、タスク シーケンスがイメージ ファイル (.WIM) にキャプチャされたドライブ文字を使用するかどうかを判断します。 この変数の値を **False** に設定して、**[オペレーティング システムの適用]** タスク シーケンス ステップの **[適用先]** 設定で指定した場所を使用します。 詳細については、「 [Apply Operating System Image](task-sequence-steps.md#BKMK_ApplyOperatingSystemImage)」を参照してください。|  
|SMSTSAssignmentsDownloadInterval|ポリシーが返されなかった前回の試行から、ポリシーのダウンロードをクライアントが試行するまで待機する秒数。 既定では、クライアントは **0** 秒待機してから再試行します。<br /><br /> この変数は、メディアまたは PXE から起動前コマンドを使用して設定できます。|  
|SMSTSAssignmentsDownloadRetry|初回の試行でポリシーが見つからなかった場合に、ポリシーのダウンロードをクライアントが試行する回数。 既定では、クライアントは **0** 回再試行します。<br /><br /> この変数は、メディアまたは PXE から起動前コマンドを使用して設定できます。|  
|SMSTSAssignUsersMode|タスク シーケンスがユーザーを対象コンピューターと関連付ける方法を示します。 変数に次のいずれかの値を設定します。<br /><br /> -   **自動**: タスク シーケンスで、オペレーティング システムを対象コンピューターに展開するときに、指定されたユーザーと対象コンピューターの間の関係を作成します。<br />-   **保留中**: タスク シーケンスで、指定されたユーザーと対象コンピューターの間の関係を作成します。 管理者は関係を承認して設定する必要があります。<br />-   **無効**: タスク シーケンスでは、オペレーティング システムの展開時にユーザーを対象コンピューターに関連付けません。|  
|SMSTSDownloadAbortCode|この変数には、(SMSTSDownloadProgram 変数で指定された) 外部プログラム ダウンローダーの中止コード値が含まれます。 プログラムが SMSTSDownloadAbortCode 変数の値と等しいエラー コードを返した場合、コンテンツのダウンロードは失敗し、他のダウンロード方法は試されません。
|SMSTSDownloadProgram|この変数を使用して代替のコンテンツ プロバイダーを指定します。このプロバイダーは、タスク シーケンスで既定の Configuration Manager ダウンローダーの代わりにコンテンツをダウンロードするために使用されます。 コンテンツのダウンロード プロセスの一部として、タスク シーケンスは、指定されているダウンローダー プログラムの変数を確認します。 指定されている場合、タスク シーケンスはそのプログラムでダウンロードを実行します。|  
|SMSTSDownloadRetryCount|Configuration Manager が配布ポイントからのコンテンツのダウンロードを試行する回数。 既定では、クライアントは **2** 回再試行します。|  
|SMSTSDownloadRetryDelay|配布ポイントからのコンテンツのダウンロードを再試行する前に Configuration Manager が待機する秒数。 既定では、クライアントは **15** 秒待機してから再試行します。|
|SMSTSDriverReceiveTimeOut|サーバーへの接続がタイムアウトするまでの秒数。|
|SMSTSErrorDialogTimeout|タスク シーケンスでエラーが発生すると、エラーを示すダイアログ ボックスが表示されます。 タスク シーケンスでは、この変数で指定された秒数の経過後にダイアログ ボックスが自動的に閉じられます。 既定では、この値は **900** 秒 (15 分) です。|  
| TSDisableProgressUI | <!-- 1354291 -->Configuration Manager バージョン 1706 以降では、この変数を使って、タスク シーケンスが進行状況をエンド ユーザーに表示するタイミングを制御します。 異なる時点で進行状況の非表示または表示を切り替えるには、タスク シーケンス内で複数回この変数を設定します。 タスク シーケンスの進行状況を非表示にするには、この変数の値を **True** に設定します。 タスク シーケンスの進行状況を表示するには、この変数の値を **False** に設定します。 | 
| SMSTSDisableStatusRetry | <!--512358--> 切断されたシナリオでは、タスク シーケンス エンジンが管理ポイントへのステータス メッセージの送信を繰り返し試行します。 このシナリオのこの動作によって、タスク シーケンスの処理に遅延が発生します。 Configuration Manager バージョン 1802 以降では、この変数を **True** に設定すると、タスク シーケンス エンジンは最初のメッセージの送信に失敗した後でステータス メッセージの送信を試行しません。 この最初の試行には複数回の再試行が含まれます。<br/><br/>タスク シーケンスの再開時に、この変数の値は保持されます。 ただし、タスク シーケンスでは初期ステータス メッセージの送信が試行されます。 この最初の試行には複数回の再試行が含まれます。 成功した場合、この変数の値に関係なく、タスク シーケンスではステータスの送信が続行されます。 ステータスの送信に失敗した場合、タスク シーケンスではこの変数の値が使用されます。<br/><br/>注: [タスク シーケンス状態レポート](/sccm/core/servers/manage/list-of-reports#task-sequence---deployment-status)は、これらのステータス メッセージに基づいて、各ステップの進捗、履歴、詳細を表示します。 | 
|SMSTSLanguageFolder|言語に依存しないブート イメージの表示言語を変更するときに使用します。|  
|SMSTSLocalDataDrive|タスク シーケンスの実行中に一時ファイルを対象コンピューターに格納する場所を指定します。<br /><br /> この変数は、コレクション変数の設定によって行うなど、タスク シーケンスが開始する前に設定される必要があります。 タスク シーケンスが開始された後で、Configuration Manager は _SMSTSMDataPath 変数を定義します。|  
|SMSTSMP|この変数を使用して、Configuration Manager の管理ポイントの URL または IP アドレスを指定します。|  
|SMSTSPeerDownload|この変数を使用して、クライアントに Windows PE ピア キャッシュの使用を許可します。<br /><br /> 例:<br /><br /> この機能は、SMSTSPeerDownload  = **TRUE** により有効になります。|  
|SMSTSPeerRequestPort|Windows PE ピア キャッシュで初期ブロードキャストに使用されるカスタム ネットワーク ポート。 クライアント設定で構成されている既定のポートは 8004 です。|  
|SMSTSPersistContent|コンテンツをタスク シーケンス キャッシュに一時的に保存するときに使用します。|  
|SMSTSPostAction|タスク シーケンスの完了後に実行されるコマンドを指定します。 たとえば、指定のデバイスにタスク シーケンスがオペレーティング システムを展開した後、埋め込みデバイスでフィルターを有効にするスクリプトを記述するのにこの変数を使用できます。|  
|SMSTSPreferredAdvertID|タスク シーケンスで対象コンピューターでの特定の展開が実行されるように強制します。 この変数は、メディアまたは PXE から起動前コマンドを使用して設定します。 この変数が設定されると、タスク シーケンスは要求されたすべての展開を上書きします。|  
|SMSTSPreserveContent|この変数は、展開後に Configuration Manager クライアント キャッシュに残すタスク シーケンス内のコンテンツにフラグを設定します。 この変数は、タスク シーケンスの持続期間だけコンテンツを保持する、SMSTSPersistContent とは異なります。 SMSTSPersistContent ではタスク シーケンス キャッシュを使用し、SMSTSPreserveContent では Configuration Manager クライアント キャッシュを使用します。<br /><br /> 例:<br /><br /> この機能は、SMSTSPreserveContent = **TRUE** により有効になります。|  
|SMSTSRebootDelay|コンピューターが再起動するまでの待機時間を秒単位で指定します。 この変数がゼロ (0) の場合、タスク シーケンス マネージャーは再起動の前に通知ダイアログを表示しません。<br /><br /> 次に例を示します。<br /><br /> **0**: 通知を表示しない<br /><br /> **60**: 1 分間通知を表示する|  
|SMSTSRebootMessage|再起動通知ダイアログに表示するメッセージを指定します。 この変数を設定しない場合、既定のメッセージが表示されます。<br /><br /> 例:<br /><br /> **このコンピューターはタスク シーケンスで再起動されます**。|  
|SMSTSRebootRequested|現在のタスク シーケンスのステップを完了した後で再起動が必要であることを示します。 再起動が必要な場合は、この変数を **TRUE**に設定すると、このタスク シーケンス ステップの後で、タスク シーケンス マネージャーが自動的にコンピューターを再起動します。 タスク シーケンス ステップでアクションを完了するために再起動が必要な場合は、この変数を設定します。 コンピューターの再起動後、タスク シーケンスは次のタスク シーケンス ステップから続行されます。|  
|SMSTSRetryRequested|現在のタスク シーケンスのステップを完了した後で再試行を要求します。 このタスク シーケンス変数を設定した場合、 **SMSTSRebootRequested** も **TRUE**に設定する必要があります。 コンピューターの再起動後、タスク シーケンス マネージャーは同じタスク シーケンスのステップを再実行します。|  
|SMSTSUDAUsers|次の形式を使用して、対象コンピューターのプライマリ ユーザーを指定します。<br /><br /> 例:<br /><br /> **domain\user1, domain\user2, domain\user3**<br /><br /> 複数のユーザーは、コンマ (,) で区切ります。 詳細については、「[System Center Configuration Manager でユーザーをセットアップ先のコンピューターに関連付ける](../get-started/associate-users-with-a-destination-computer.md)」を参照してください。|  
 
